---
// src/pages/feedback.astro
import Layout from '../layouts/Layout.astro';
import Navbar from "../components/Navbar";
import FooterNav from "../components/FooterNav.astro";
import Footer from "../components/Footer.astro";
import Studentsurvey from "../pages/studentsurvey.astro";
import Regstudentsurvey from "../pages/regstudent.astro";
import '../styles/css/global.css';

const currentPath = Astro.url.pathname;
---

<Layout title="MSUTCTO - Office Evaluation and Students Survey">
  <main>
    <Navbar path={currentPath} client:visible />

    <!-- Main Content Container -->
    <div class="min-h-screen bg-gray-50 dark:bg-gray-900">
      <!-- Tab Navigation -->
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl mb-8 mt-8 sticky top-0 bg-gray-50 dark:bg-gray-900 z-10 pt-4">
        <div class="flex overflow-x-auto pb-2">
          <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg mr-2 font-medium dark:text-white dark:hover:text-[#61063B]" data-tab="office-evaluation">
            Office Evaluation
          </button>
          <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg font-medium dark:text-white dark:hover:text-[#61063B]" data-tab="student-survey">
            New Student Survey
          </button>
            <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg font-medium dark:text-white dark:hover:text-[#61063B]" data-tab="studentreg-survey">
            Regular Student Survey
          </button>
        </div>
      </div>

      <!-- Office Evaluation Tab Content -->
      <div id="office-evaluation" class="tab-content">
        <section id="service" class="bg-gradient-to-b from-gray-50 to-white dark:from-gray-900 dark:to-gray-800 py-16 md:py-24">
          <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl">
            <div class="text-center mb-16">
              <span class="inline-block px-4 py-2 bg-msu-main-color/10 dark:bg-[#61063B]/20 text-msu-main-color dark:bg-gradient-to-r dark:from-[#61063B] dark:to-white dark:bg-clip-text dark:text-transparent text-sm font-semibold rounded-full mb-4">
                Service Feedback
              </span>
              <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">
                Office Service <span class="text-msu-main-color dark:bg-gradient-to-r dark:from-[#61063B] dark:to-white dark:bg-clip-text dark:text-transparent">Evaluation</span>
              </h2>
              <div class="w-24 h-1.5 bg-gradient-to-r from-msu-gold to-msu-maroon dark:from-[#61063B] dark:to-white mx-auto rounded-full"></div>
              <p class="text-lg text-gray-600 dark:text-gray-300 mt-6 max-w-2xl mx-auto">
                Your feedback helps us maintain excellence in university services
              </p>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700">
              <div class="bg-gradient-to-r from-msu-main-color to-msu-maroon px-8 py-6">
                <div class="flex items-center">
                  <div class="bg-white/20 p-2 rounded-lg mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-xl font-semibold text-white">Service Quality Assessment</h3>
                    <p class="text-white">Please complete all required fields</p>
                  </div>
                </div>
              </div>

                              <div class="p-6 sm:p-8 md:p-10">
                  <form id="evaluationForm" class="space-y-10">
                  
                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 dark:bg-yellow-400/20 text-msu-main-color dark:text-yellow-400 mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 border-b dark:border-gray-600 pb-2">Office Information</h4>
                        
                        <div class="mb-8">
                          <label for="globalSearch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Find Office or Service
                          </label>
                          <div class="relative rounded-lg shadow-sm">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                              <svg class="h-5 w-5 text-gray-400 dark:text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                              </svg>
                            </div>
                            <input
                              type="text"
                              id="globalSearch"
                              class="block w-full pl-10 pr-12 py-3 border text-gray-700 dark:text-gray-200 dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 dark:focus:ring-yellow-400/50 focus:border-msu-main-color dark:focus:border-yellow-400 transition-all"
                              placeholder="Search all offices and services..."
                              autocomplete="off"
                            />
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                              <span class="text-gray-500 dark:text-gray-400 text-sm hidden sm:inline">Press âŒ˜K</span>
                            </div>
                          </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                          <div class="form-group">
                            <label for="office" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center">
                              Office to Evaluate
                              <span class="text-msu-maroon dark:text-red-400 ml-1">*</span>
                            </label>
                            <div class="mt-1 relative">
                              <select 
                                id="office" 
                                name="entry.1924231474" 
                                required
                                class="office-select block w-full pl-4 pr-10 py-3 text-gray-700 dark:text-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 dark:focus:ring-yellow-400/50 focus:border-msu-main-color dark:focus:border-yellow-400 transition-all hover:border-gray-400 dark:hover:border-gray-500"
                              >
                                <option value="" disabled selected>Select an office</option>
                                <optgroup label="Administrative Offices" class="text-gray-900">
                                  <option value="BUDGET OFFICE">Budget Office</option>
                                  <option value="INTERNAL CONTROL AND AUDIT UNIT">Internal Control and Audit Unit</option>
                                  <option value="ACCOUNTING OFFICE">Accounting Office</option>
                                  <option value="CASHIERING OFFICE">Cashiering Office</option>
                                  <option value="OFFICE OF THE CHANCELLOR">Office of the Chancellor</option>
                                  <option value="EXTENSION SERVICES">Extension Services</option>
                                  <option value="GENERAL SERVICES OFFICE">General Services Office</option>
                                  <option value="OFFICE OF MEDICAL AND WELLNESS SERVICES">Office of Medical and Wellness Services</option>
                                  <option value="MANILA INFORMATION AND LIAISON OFFICE">Manila Information and Liaison Office</option>
                                  <option value="OFFICE OF THE FINANCE DIR">Office of the Finance Director</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR ADMINISTRATION AND FINANCE">Vice Chancellor for Administration and Finance</option>
                                  <option value="HUMAN RESOURCE DEVELOPMENT OFFICE">Human Resource Development Office</option>
                                  <option value="PHYSICAL PLANT OFFICE">Physical Plant Office</option>
                                  <option value="PROCUREMENT OFFICE">Procurement Office</option>
                                  <option value="RESEARCH SERVICES">Research Services</option>
                                  <option value="SECURITY FORCE">Security Force</option>
                                  <option value="SUPPLY AND PROPERTY OFFICE">Supply and Property Office</option>
                                  <option value="ADMISSION OFFICE">Admission Office</option>
                                  <option value="ALUMNI AND CAREER CENTER OFFICE">Alumni and Career Center Office</option>
                                  <option value="CAGAYAN DE TAWI-TAWI COLLEGE OF ARTS AND SCIENCES EXTENSION">Cagayan de Tawi-Tawi College of Arts and Sciences Extension</option>
                                  <option value="CENTER FOR OCEAN STUDIES">Center for Ocean Studies</option>
                                  <option value="CHILD DEVELOPMENT CENTER">Child Development Center</option>
                                  <option value="COLLEGE LIBRARY">College Library</option>
                                  <option value="COLLEGE OF EDUCATION">College of Education</option>
                                  <option value="INSTITUTE OF INFORMATION AND COMMUNICATIONS TECHNOLOGY">Institute of Information and Communications Technology</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - LANGUAGE DEPARTMENT">College of Arts and Sciences - Language Department</option>
                                  <option value="GRADUATE SCHOOL">Graduate School</option>
                                  <option value="COLLEGE OF FISHERIES">College of Fisheries</option>
                                  <option value="COLLEGE OF ISLAMIC AND ARABIC STUDIES">College of Islamic and Arabic Studies</option>
                                  <option value="COLLEGE OF FISHERIES - MARINE FISHERIES DEPARTMENT">College of Fisheries - Marine Fisheries Department</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - MATHEMATICS AND SCIENCES DEPARTMENT">College of Arts and Sciences - Mathematics and Sciences Department</option>
                                  <option value="OCEANOGRAPHY AND FISH TECHNOLOGY CENTER">Oceanography and Fish Technology Center</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR ACADEMIC SUPPORT SERVICES">Office of the Director for Academic Support Services</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR ACADEMIC AFFAIRS">Office of the Vice Chancellor for Academic Affairs</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - SPEAR DEPARTMENT">College of Arts and Sciences - SPEAR Department</option>
                                  <option value="OFFICE OF THE REGISTRAR">Office of the Registrar</option>
                                  <option value="SCIENCE HIGH SCHOOL">Science High School</option>
                                  <option value="SIBUTU COLLEGE OF ARTS AND SCIENCES EXTENSION">Sibutu College of Arts and Sciences Extension</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - SOCIAL SCIENCES DEPARTMENT">College of Arts and Sciences - Social Sciences Department</option>
                                  <option value="UNGUS MATATA COLLEGE OF ARTS AND SCIENCES EXTENSION">Ungus Matata College of Arts and Sciences Extension</option>
                                  <option value="BAKONG COMMUNITY HIGH SCHOOL">Bakong Community High School</option>
                                  <option value="BANARAN COMMUNITY HIGH SCHOOL">Banaran Community High School</option>
                                  <option value="BUAN COMMUNITY HIGH SCHOOL">Buan Community High School</option>
                                  <option value="MAPUN COMMUNITY HIGH SCHOOL">Mapun Community High School</option>
                                  <option value="EASTERN TAWI-TAWI SECONDARY SCHOOLS">Eastern Tawi-Tawi Secondary Schools</option>
                                  <option value="LANGUYAN COMMUNITY HIGH SCHOOL">Languyan Community High School</option>
                                  <option value="LARAP COMMUNITY HIGH SCHOOL">Larap Community High School</option>
                                  <option value="MANTABUAN COMMUNITY HIGH SCHOOL">Mantabuan Community High School</option>
                                  <option value="MANUK-MANGKAW COMMUNITY HIGH SCHOOL">Manuk-Mangkaw Community High School</option>
                                  <option value="SAPA-SAPA COMMUNITY HIGH SCHOOL">Sapa-Sapa Community High School</option>
                                  <option value="SIBUTU COMMUNITY HIGH SCHOOL">Sibutu Community High School</option>
                                  <option value="SITANGKAI SITANGKAI HIGH SCHOOL">Sitangkai Sitangkai High School</option>
                                  <option value="SOUTH UBIAN COMMUNITY HIGH SCHOOL">South Ubian Community High School</option>
                                  <option value="TABAWAN COMMUNITY HIGH SCHOOL">Tabawan Community High School</option>
                                  <option value="TAMPAKAN COMMUNITY HIGH SCHOOL">Tampakan Community High School</option>
                                  <option value="TANDUBANAK COMMUNITY HIGH SCHOOL">Tandubanak Community High School</option>
                                  <option value="TUBIG INDANGAN COMMUNITY HIGH SCHOOL">Tubig Indangan Community High School</option>
                                  <option value="UNGUS MATATA COMMUNITY HIGH SCHOOL">Ungus Matata Community High School</option>
                                  <option value="WESTERN TAWI-TAWI COMMUNITY SCHOOL">Western Tawi-Tawi Community School</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL">Integrated Laboratory School</option>
                                  <option value="INFORMATION AND COMMUNICATIONS TECHNOLOGY OFFICE">Information and Communications Technology Office</option>
                                  <option value="REMITTING OFFICE">Remitting Office</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - JUNIOR HIGH SCHOOL DEPARTMENT">Integrated Laboratory School - Junior High School Department</option>
                                  <option value="GRADUATE SCHOOL_SCHOLAR">Graduate School Scholar</option>
                                  <option value="COLLEGE OF EDUCATION_SCHOLAR">College of Education Scholar</option>
                                  <option value="UNGUS MATATA EXTENSION_SCHOLAR">Ungus Matata Extension Scholar</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - STANDARD BASIC EDUCATION CURRICULUM">Integrated Laboratory School - Standard Basic Education Curriculum</option>
                                  <option value="MSU-TCTO LANGUYAN SECONDARY">MSU-TCTO Languyan Secondary</option>
                                  <option value="COLLEGE OF FISHERIES - INLAND FISHERIES DEPARTMENT">College of Fisheries - Inland Fisheries Department</option>
                                  <option value="MAPUN CAS EXTENSION">Mapun CAS Extension</option>
                                  <option value="OFFICE OF THE CAMPUS SECRETARY">Office of the Campus Secretary</option>
                                  <option value="CAFETERIA">Cafeteria</option>
                                  <option value="SAPA COMMUNITY HIGH SCHOOL">Sapa Community High School</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR RESEARCH INNOVATION DEVELOPMENT AND EXTENSION">Office of the Vice Chancellor for Research Innovation Development and Extension</option>
                                  <option value="SECONDARY EDUCATION DEPARTMENT">Secondary Education Department</option>
                                  <option value="BAC SECRETARIAT OFFICE">BAC Secretariat Office</option>
                                  <option value="OFFICE OF THE SUPERVISORS FOR SECONDARY SCHOOLS">Office of the Supervisors for Secondary Schools</option>
                                  <option value="SPORT DEVELOPMENT OFFICE">Sport Development Office</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR ADMINISTRATION">Office of the Director for Administration</option>
                                  <option value="OFFICE OF THE INFORMATION AND PRESS PUBLICATIONS">Office of the Information and Press Publications</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR STUDENT AFFAIRS">Office of the Vice Chancellor for Student Affairs</option>
                                  <option value="OFFICE OF CULTURAL AFFAIRS AND DEVELOPMENT">Office of Cultural Affairs and Development</option>
                                  <option value="INTEGRATED FISHERIES RESEARCH AND TRAINING CENTER (IFRTC)">Integrated Fisheries Research and Training Center (IFRTC)</option>
                                  <option value="MSU-TCTO MAPUN SECONDARY">MSU-TCTO Mapun Secondary</option>
                                  <option value="OFFICE OF INTERNATIONAL LINKAGES">Office of International Linkages</option>
                                  <option value="INTEGRATED SCIENCE LABORATORY">Integrated Science Laboratory</option>
                                  <option value="COLLEGE OF FISHERIES - MULTI-SPECIES HATCHERY">College of Fisheries - Multi-Species Hatchery</option>
                                  <option value="INSTITUTE OF ENVIRONMENTAL SCIENCE">Institute of Environmental Science</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR RESEARCH SERVICES">Office of the Director for Research Services</option>
                                  <option value="MARINE SCIENCE MUSEUM">Marine Science Museum</option>
                                  <option value="OCEANES">OCEANES</option>
                                  <option value="ZAMDIQA">ZAMDIQA</option>
                                  <option value="GENDER AND DEVELOPMENT OFFICE">Gender and Development Office</option>
                                  <option value="OFFICE OF THE AUDITOR">Office of the Auditor</option>
                                  <option value="TAWSIH RESIDENCE HALL">Tawsih Residence Hall</option>
                                  <option value="LINGGISAN RESIDENCE HALL">Linggisan Residence Hall</option>
                                  <option value="INSTITUTE FOR PEACE & DEVELOPMENT IN MINDANAO">Institute for Peace & Development in Mindanao</option>
                                  <option value="RADYO KASANNANGAN">Radyo Kasannangan</option>
                                  <option value="FOOD INNOVATION CENTER">Food Innovation Center</option>
                                  <option value="SAMA STUDIES CENTER">Sama Studies Center</option>
                                  <option value="AMERICAN CORNER">American Corner</option>
                                  <option value="QUALITY ASSURANCE & ACCREDITATION OFFICE">Quality Assurance & Accreditation Office</option>
                                  <option value="COLLEGE OF LAW TAWI-TAWI EXTENSION">College of Law Tawi-Tawi Extension</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - STANDARD MADRASAH EDUCATION CURRICULUM">Integrated Laboratory School - Standard Madrasah Education Curriculum</option>
                                  <option value="SECURITY FORCE BONGAO CAMPUS">Security Force Bongao Campus</option>
                                  <option value="SECURITY FORCE SANGA-SANGA CAMPUS">Security Force Sanga-Sanga Campus</option>
                                  <option value="HENRY V. KONG GYM">Henry V. Kong Gym</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - SENIOR HIGH SCHOOL DEPARTMENT">Integrated Laboratory School - Senior High School Department</option>
                                  <option value="SENTRO NG WIKA AT KULTURA">Sentro ng Wika at Kultura</option>
                                  <option value="BOYS DORMITORY">Boys Dormitory</option>
                                  <option value="GIRLS DORMITORY">Girls Dormitory</option>
                                  <option value="FLOATING CAGE">Floating Cage</option>
                                  <option value="MSU-TCTO FISHPOND">MSU-TCTO Fishpond</option>
                                  <option value="SEARDEC">SEARDEC</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES">College of Arts and Sciences</option>
                                  <option value="GUIDANCE AND COUNSELING OFFICE">Guidance and Counseling Office</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR PLANNING & DEVELOPMENT">Office of the Vice Chancellor for Planning & Development</option>
                                </optgroup>
                              </select>
                              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                              </div>
                            </div>
                            <p class="mt-1 text-sm text-red-600 dark:text-red-400 hidden" id="office-error">Please select an office</p>
                          </div>
                          
                          <div class="form-group">
                            <label for="status" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center">
                              Your Status
                              <span class="text-msu-maroon dark:text-red-400 ml-1">*</span>
                            </label>
                            <div class="mt-1 relative">
                              <select 
                                id="status" 
                                name="entry.724584061" 
                                required
                                class="block w-full pl-4 pr-10 py-3 text-gray-700 dark:text-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 dark:focus:ring-yellow-400/50 focus:border-msu-main-color dark:focus:border-yellow-400 transition-all hover:border-gray-400 dark:hover:border-gray-500"
                              >
                                <option value="" disabled selected>Select your status</option>
                                <option value="Permanent">Permanent</option>
                                <option value="Temporary">Temporary</option>
                                <option value="Contractual">Contractual</option>
                                <option value="Contract of Service">Contract of Service</option>
                                <option value="Casual">Casual</option>
                                <option value="Regular">Regular</option>
                                <option value="Provisional">Provisional</option>
                                <option value="Others">Others</option>
                              </select>
                              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400 dark:text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                              </div>
                            </div>
                            <p class="mt-1 text-sm text-red-600 dark:text-red-400 hidden" id="status-error">Please select your status</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 dark:bg-yellow-400/20 text-msu-main-color dark:text-yellow-400 mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 border-b dark:border-gray-600 pb-2">Service Ratings</h4>
                        
                        <div class="space-y-8">
                          {[
                            {
                              id: 'job_knowledge',
                              title: 'Job Knowledge',
                              description: 'Understanding and application of job requirements',
                              field: 'entry.1195783547'
                            },
                            {
                              id: 'work_quality',
                              title: 'Service Quality',
                              description: 'Accuracy and effectiveness of service provided',
                              field: 'entry.229158245'
                            },
                            {
                              id: 'responsiveness',
                              title: 'Responsiveness',
                              description: 'Timeliness in addressing requests and concerns',
                              field: 'entry.1473816641'
                            },
                            {
                              id: 'courtesy',
                              title: 'Courtesy',
                              description: 'Professionalism and politeness of staff',
                              field: 'entry.2058011824'
                            },
                            {
                              id: 'overall',
                              title: 'Overall Satisfaction',
                              description: 'Your overall experience with this office',
                              field: 'entry.28013097'
                            }
                          ].map((item) => (
                            <div class="form-group">
                              <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-3">
                                <label class="text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center">
                                  {item.title}
                                  <span class="text-msu-maroon dark:text-red-400 ml-1">*</span>
                                </label>
                                <span class="text-xs text-gray-500 dark:text-gray-400 mt-1 sm:mt-0">
                                  {item.description}
                                </span>
                              </div>
                              
                              <div class="mt-4">
                                <div class="flex items-center justify-between">
                                  {[1, 2, 3, 4, 5].map((rating) => (
                                    <div class="flex flex-col items-center">
                                      <input
                                        type="radio" 
                                        id={`${item.id}${rating}`}
                                        name={item.field}
                                        value={rating}
                                        required
                                        class="h-5 w-5 text-msu-main-color dark:text-yellow-400 focus:ring-msu-main-color dark:focus:ring-yellow-400 border-gray-300 dark:border-gray-600 dark:bg-gray-700"
                                      />
                                      <label for={`${item.id}${rating}`} class="mt-2 text-xs font-medium text-gray-500 dark:text-gray-400">
                                        {
                                        rating === 1 ? 'Very Poor' : 
                                        rating === 2 ? 'Poor' : 
                                        rating === 3 ? 'Neutral' : 
                                        rating === 4 ? 'Good' : 
                                        rating === 5 ? 'Great' : ''}
                                      </label>
                                    </div>
                                  ))}
                                </div>
                                <p class="mt-1 text-sm text-red-600 dark:text-red-400 hidden" id={`${item.id}-error`}>Please select a rating</p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 dark:bg-yellow-400/20 text-msu-main-color dark:text-yellow-400 mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 border-b dark:border-gray-600 pb-2">Additional Feedback</h4>
                        
                        <div class="form-group">
                          <label for="comments" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Specific feedback or suggestions for improvement
                            <span class="text-sm text-gray-500 dark:text-gray-400 font-normal">(Optional)</span>
                          </label>
                          <textarea 
                            id="comments" 
                            name="entry.1589457788" 
                            rows="4"
                            placeholder="Please share any specific experiences or suggestions that could help us improve... (This field is optional)"
                            class="block w-full px-4 py-3 text-gray-700 dark:text-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-msu-main-color/50 dark:focus:ring-yellow-400/50 focus:border-msu-main-color dark:focus:border-yellow-400 transition-all hover:border-gray-400 dark:hover:border-gray-500"
                          ></textarea>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="pt-6">
                    <div class="flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0">
                      <p class="text-sm text-gray-500 dark:text-gray-400">
                        All responses are confidential and will be used for service improvement.
                      </p>
                      <button
                        type="submit"
                        id="submitBtn"
                        class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-gradient-to-r from-msu-main-color to-msu-maroon dark:bg-[#61063B] hover:from-msu-main-color-dark hover:to-msu-maroon-dark dark:hover:bg-[#61063B] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-msu-main-color dark:focus:ring-[#61063B] transition-all transform hover:-translate-y-0.5 hover:shadow-md disabled:opacity-70 disabled:cursor-not-allowed"
                      >
                        <span id="submitText">Submit Evaluation</span>
                        <svg id="submitSpinner" class="hidden h-5 w-5 ml-2 animate-spin text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <svg id="submitArrow" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 -mr-1" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </section>
      </div>


      <!-- Student Survey Tab Content -->

        <Studentsurvey class="relative z-50"/>



        <Regstudentsurvey class="relative z-50"/>
      </div>
    </div>

    <!-- FooterNaV -->
    <FooterNav class="relative z-50"/>
    <!-- end FooterNaV -->
    <!-- Footer -->
    <Footer class="relative z-50"/>
    <!-- end Footer -->
  </main>

  <!-- Modal Structure -->
  <div id="feedbackModal" class="feedback-modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <div class="modal-title">Success!</div>
      </div>
      <div class="modal-body">
        <p id="modalMessage">Your feedback has been submitted successfully!</p>
      </div>
      <div class="modal-footer">
        <button id="modalCloseButton" class="modal-button modal-button-primary">OK</button>
      </div>
    </div>
  </div>

  <style is:global>

    /* Tab Navigation Styles */
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }
    .tab-btn {
      transition: all 0.3s ease;
      background-color: #f3f4f6;
      color: #1e3a8a;
      border: 1px solid #d1d5db;
      position: relative;
    }
    .dark .tab-btn {
      background-color: #374151;
      color: white;
      border-color: #4b5563;
    }
    .tab-btn.active {
      background-color: #1e3a8a;
      color: white;
      border-color: #1e3a8a;
    }
    .dark .tab-btn.active {
      background-color: #61063B;
      color: white;
      border-color: #61063B;
    }
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 3px;
      background-color: #1e3a8a;
    }
    .dark .tab-btn.active::after {
      background-color: #61063B;
    }
    
    /* Enhanced Service Selection Styles */
    .service-card {
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      transition: all 0.3s ease;
      cursor: pointer;
      margin-bottom: 1.5rem;
      overflow: hidden;
    }
    .dark .service-card {
      border-color: #374151;
      background-color: #1f2937;
    }
    
    .service-card:hover {
      border-color: #1e3a8a;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }
    .dark .service-card:hover {
      border-color: #61063B;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    }
    
    .service-card.selected {
      border-color: #1e3a8a;
      background-color: #f0f4ff;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    .dark .service-card.selected {
      border-color: #61063B;
      background-color: rgba(97, 6, 59, 0.1);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
    }
    
    .service-card-header {
      display: flex;
      align-items: center;
      padding: 1.25rem;
      position: relative;
      padding-left: 3.5rem !important;
      background-color: white;
    }
    .dark .service-card-header {
      background-color: #1f2937;
    }
    
    .service-card-icon {
      flex-shrink: 0;
      height: 2.5rem;
      width: 2.5rem;
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      background-color: #1e3a8a10;
      color: #1e3a8a;
      transition: all 0.3s ease;
    }
    .dark .service-card-icon {
      background-color: rgba(97, 6, 59, 0.1);
      color: #61063B;
    }
    
    .service-card.selected .service-card-icon {
      background-color: #1e3a8a;
      color: white;
    }
    .dark .service-card.selected .service-card-icon {
      background-color: #eab308;
      color: #111827;
    }
    
    .service-card-title {
      font-weight: 600;
      color: #111827;
      font-size: 1.1rem;
    }
    .dark .service-card-title {
      color: #e5e7eb;
    }
    
    .service-card-checkbox {
      position: absolute;
      opacity: 0;
    }
    
    .service-questions {
      display: none;
      padding: 1.5rem;
      border-top: 1px solid #e5e7eb;
      background-color: #f9fafb;
    }
    .dark .service-questions {
      border-top: 1px solid #374151;
      background-color: #111827;
    }
    
    .service-card.selected .service-questions {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    /* Verification Status Styles */
    .verification-status {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      z-index: 2;
    }
    
    .verification-status.verified {
      background-color: #10B981;
      color: white;
    }
    
    .verification-status.completed {
      background-color: #F59E0B;
      color: white;
    }
    
    .verification-status.not-completed {
      background-color: #EF4444;
      color: white;
    }
    
    .verification-legend {
      background-color: #F9FAFB;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
      border: 1px solid #E5E7EB;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .dark .verification-legend {
      background-color: #1f2937;
      border-color: #374151;
      box-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    
    .verification-legend-item {
      display: flex;
      align-items: center;
      font-size: 0.875rem;
      color: #4B5563;
    }
    .dark .verification-legend-item {
      color: #9CA3AF;
    }
    
    .verification-legend-badge {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      margin-right: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }
    
    .verification-legend-badge.verified {
      background-color: #10B981;
      color: white;
    }
    
    .verification-legend-badge.completed {
      background-color: #F59E0B;
      color: white;
    }
    
    .verification-legend-badge.not-completed {
      background-color: #EF4444;
      color: white;
    }

    /* Modal Styles */
    .feedback-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    
    .feedback-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-content {
      background-color: white;
      border-radius: 12px;
      width: 90%;
      max-width: 450px;
      transform: translateY(20px);
      transition: all 0.3s ease;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    .dark .modal-content {
      background-color: #1f2937;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4);
    }
    
    .feedback-modal.active .modal-content {
      transform: translateY(0);
    }
    
    .modal-header {
      padding: 1.5rem;
      display: flex;
      align-items: center;
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      color: white;
    }
    .dark .modal-header {
      background: linear-gradient(135deg, #eab308, #f59e0b);
      color: #111827;
    }
    
    .modal-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
    }
    
    .modal-body {
      padding: 1.5rem;
      color: #4b5563;
      line-height: 1.6;
    }
    .dark .modal-body {
      color: #d1d5db;
    }
    
    .modal-footer {
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: flex-end;
      border-top: 1px solid #e5e7eb;
    }
    .dark .modal-footer {
      border-top: 1px solid #374151;
    }
    
    .modal-button {
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .modal-button-primary {
      background-color: #1e3a8a;
      color: white;
      border: none;
    }
    .dark .modal-button-primary {
      background-color: #eab308;
      color: #111827;
    }
    
    .modal-button-primary:hover {
      background-color: #1e40af;
    }
    .dark .modal-button-primary:hover {
      background-color: #f59e0b;
    }
    
    /* Success/Error Specific Styles */
    .modal-success .modal-icon {
      background-color: rgba(16, 185, 129, 0.2);
    }
    
    .modal-error .modal-icon {
      background-color: rgba(239, 68, 68, 0.2);
    }
    
    /* Loading Spinner */
    .submit-loading {
      display: inline-flex;
      align-items: center;
    }
    
    .spinner {
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
    }

    /* Progress tracker */
    .studentprogress-tracker {
      position: fixed;
      bottom: 2rem;
      left: 2rem;
      background: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      z-index: 20;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .studentprogress-tracker:hover {
      transform: scale(1.1);
    }
    
    .progress-circle {
      position: relative;
      width: 50px;
      height: 50px;
    }
    
    .progress-bg {
      fill: none;
      stroke: #e5e7eb;
      stroke-width: 4;
    }
    
    .progress-fill {
      fill: none;
      stroke: #1e3a8a;
      stroke-width: 4;
      stroke-linecap: round;
      transform-origin: center;
      transform: rotate(-90deg);
      transition: stroke-dashoffset 0.5s ease;
    }
    
    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.75rem;
      font-weight: bold;
      color: #1e3a8a;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideDown {
      from { 
        opacity: 0;
        transform: translateY(-10px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Enhanced Loader Styles (from regstudent) */
    .loader-container {
      min-width: 320px;
      max-width: 90%;
      transition: all 0.3s ease;
      animation: slideIn 0.5s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    .loader {
      border-top-color: #1a4b8c;
      border-right-color: #1a4b8c;
      border-bottom-color: #8b1a1a;
      border-left-color: #d4af37;
      animation-timing-function: cubic-bezier(0.53, 0.21, 0.29, 0.67);
    }
    
    .animate-spin {
      animation: spin 1.2s linear infinite;
    }
    
    .progress-bar {
      transition: width 0.8s ease;
      background: linear-gradient(90deg, #1a4b8c 0%, #8b1a1a 50%, #d4af37 100%);
    }
    
    .loader-logo {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    button[disabled] {
      opacity: 0.7;
      cursor: not-allowed;
    }
    
    iframe[name="hidden_iframe"] {
      display: none;
    }

    /* Responsive adjustments */
    @media (max-width: 640px) {
      .service-card-header {
        padding-left: 2.5rem !important;
      }
      
      .verification-status {
        left: 0.75rem;
        width: 20px;
        height: 20px;
        font-size: 10px;
      }
      
      .progress-tracker {
        bottom: 1rem;
        right: 1rem;
        width: 50px;
        height: 50px;
      }
      
      .loader-container {
        min-width: 280px;
        margin: 0 1rem;
      }
    }
  </style>

  <script is:inline>
            // Enhanced Form Submission System (inspired by regstudent)
    document.addEventListener('DOMContentLoaded', function() {
        // Create hidden iframe for form submission (like regstudent)
        const hiddenIframe = document.createElement('iframe');
        hiddenIframe.name = 'hidden_iframe';
        hiddenIframe.style.display = 'none';
        document.body.appendChild(hiddenIframe);

        // Tab Functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Set initial active tab
        if (tabBtns.length > 0 && tabContents.length > 0) {
            tabBtns[0].classList.add('active');
            tabContents[0].classList.add('active');
        }
        
        tabBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const targetTab = this.dataset.tab;
                
                // Remove active class from all tabs and contents
                tabBtns.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                this.classList.add('active');
                const targetContent = document.getElementById(targetTab);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            });
        });

        // Global Search Functionality with null checks
        const globalSearch = document.getElementById('globalSearch');
        const officeSelect = document.getElementById('office');
        
        if (!globalSearch || !officeSelect) {
            console.log('Search elements not found, skipping search functionality');
            return;
        }
        
        const originalOptions = Array.from(officeSelect.options);
        
        // Create search results dropdown
        const searchResults = document.createElement('div');
        searchResults.className = 'absolute z-10 mt-1 w-full bg-white text-black shadow-lg rounded-lg border border-gray-300 hidden';
        searchResults.id = 'searchResults';
        globalSearch.parentNode.appendChild(searchResults);
        
        // Keyboard shortcut hint
        globalSearch.addEventListener('keydown', function(e) {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                this.focus();
            }
        });
        
        globalSearch.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            searchResults.innerHTML = '';
            
            if (searchTerm.length < 2) {
                searchResults.classList.add('hidden');
                return;
            }
            
            // Filter options
            const matches = originalOptions.filter(option => 
                option.value && option.text.toLowerCase().includes(searchTerm)
            );
            
            // Group by optgroup
            const grouped = {};
            matches.forEach(option => {
                const group = option.parentNode.label || 'Other Offices';
                if (!grouped[group]) grouped[group] = [];
                grouped[group].push(option);
            });
            
            // Display results
            if (Object.keys(grouped).length > 0) {
                for (const [groupName, options] of Object.entries(grouped)) {
                    const groupHeader = document.createElement('div');
                    groupHeader.className = 'px-4 py-2 bg-gray-50 text-sm font-medium text-gray-700 border-b';
                    groupHeader.textContent = groupName;
                    searchResults.appendChild(groupHeader);
                    
                    options.forEach(option => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center';
                        resultItem.innerHTML = `
                            <svg class="h-5 w-5 text-gray-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            ${option.text}
                        `;
                        
                        resultItem.addEventListener('click', () => {
                            officeSelect.value = option.value;
                            globalSearch.value = '';
                            searchResults.classList.add('hidden');
                        });
                        
                        searchResults.appendChild(resultItem);
                    });
                }
                
                searchResults.classList.remove('hidden');
            } else {
                const noResults = document.createElement('div');
                noResults.className = 'px-4 py-2 text-gray-500';
                noResults.textContent = 'No offices found matching your search';
                searchResults.appendChild(noResults);
                searchResults.classList.remove('hidden');
            }
        });
        
        // Hide results when clicking outside
        document.addEventListener('click', function(e) {
            if (!globalSearch.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.classList.add('hidden');
            }
        });



        function showErrorModal(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/50 office-eval-error-modal';
            
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl">
                    <div class="flex items-center justify-center h-16 w-16 bg-red-100 dark:bg-red-900/30 rounded-full mx-auto mb-4">
                        <svg class="h-8 w-8 text-red-600 dark:text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100 text-center mb-2">Submission Error</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-center mb-6">${message}</p>
                    <button onclick="this.closest('.office-eval-error-modal').remove()" class="w-full px-4 py-2 bg-red-600 dark:bg-red-500 text-white rounded-lg hover:bg-red-700 dark:hover:bg-red-600 transition-colors">
                        Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Auto-close after 8 seconds
            setTimeout(() => {
                if (modal.parentNode) modal.remove();
            }, 8000);
        }

        function showSuccessModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/50 office-eval-success-modal';
            
            modal.innerHTML = `
                <div class="bg-white rounded-xl max-w-md w-full mx-4 shadow-2xl">
                    <div class="p-8 text-center">
                        <div class="flex items-center justify-center h-16 w-16 bg-green-100 rounded-full mx-auto mb-4">
                            <svg class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">Success!</h3>
                        <p class="text-gray-600 mb-6">Your evaluation has been submitted successfully. Thank you for your valuable feedback!</p>
                        <button onclick="this.closest('.office-eval-success-modal').remove()" class="w-full px-4 py-2 bg-msu-main-color text-white rounded-lg hover:bg-msu-maroon transition-colors">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Auto-close after 5 seconds
            setTimeout(() => {
                if (modal.parentNode) modal.remove();
            }, 5000);
        }

        // Internet connectivity check function
        function checkInternetConnection() {
            return new Promise((resolve) => {
                // Quick check using navigator.onLine (not always reliable)
                if (!navigator.onLine) {
                    resolve(false);
                    return;
                }
                
                // More reliable check by trying to fetch a small resource
                const timeout = new Promise((_, reject) => {
                    setTimeout(() => reject(new Error('timeout')), 5000);
                });
                
                const fetchTest = fetch('https://www.google.com/favicon.ico', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-cache'
                }).then(() => true).catch(() => false);
                
                Promise.race([fetchTest, timeout])
                    .then(resolve)
                    .catch(() => resolve(false));
            });
        }

                // Enhanced Form Submission Handler (inspired by regstudent)
        const form = document.getElementById('evaluationForm');
        let isSubmitting = false;
        
        if (form) {
            form.addEventListener('submit', function(e) {
                // Always prevent default form submission first
                e.preventDefault();
                
                console.log('=== FORM SUBMISSION STARTED ===');
                console.log('Form element:', form);
                
                // Prevent multiple submissions
                if (isSubmitting) {
                    console.log('Submission already in progress, aborting...');
                    return;
                }
                
                // Validate required fields before submission
                const office = document.getElementById('office');
                const status = document.getElementById('status');
                
                console.log('Office element:', office);
                console.log('Office value:', office?.value);
                console.log('Status element:', status);
                console.log('Status value:', status?.value);
                
                if (!office || !office.value) {
                    console.log('Validation failed: No office selected');
                    showErrorModal('Please select an office to evaluate');
                    return;
                }
                
                if (!status || !status.value) {
                    console.log('Validation failed: No status selected');
                    showErrorModal('Please select your status');
                    return;
                }
                
                // Validate rating fields
                const ratingFields = [
                    'entry.1195783547', // job_knowledge
                    'entry.229158245',  // work_quality
                    'entry.1473816641', // responsiveness
                    'entry.2058011824', // courtesy
                    'entry.28013097'    // overall
                ];
                
                console.log('Validating rating fields...');
                let allRatingsValid = true;
                let missingRatings = [];
                
                ratingFields.forEach(field => {
                    const selected = document.querySelector(`input[name="${field}"]:checked`);
                    console.log(`Field ${field}:`, selected ? 'Selected' : 'NOT SELECTED');
                    if (!selected) {
                        allRatingsValid = false;
                        const fieldName = field === 'entry.1195783547' ? 'Job Knowledge' :
                                         field === 'entry.229158245' ? 'Service Quality' :
                                         field === 'entry.1473816641' ? 'Responsiveness' :
                                         field === 'entry.2058011824' ? 'Courtesy' :
                                         field === 'entry.28013097' ? 'Overall Satisfaction' : field;
                        missingRatings.push(fieldName);
                    }
                });
                
                console.log('All ratings valid:', allRatingsValid);
                console.log('Missing ratings:', missingRatings);
                
                if (!allRatingsValid) {
                    console.log('Validation failed: Missing ratings');
                    showErrorModal(`Please provide ratings for: ${missingRatings.join(', ')}`);
                    return;
                }
                
                console.log('All validations passed! Proceeding with submission...');
                
                // Ensure comments field has a value
                const commentsField = document.getElementById('comments');
                if (commentsField && !commentsField.value.trim()) {
                    commentsField.value = 'No additional feedback provided';
                }
                
                // Set submitting state
                isSubmitting = true;
                
                // Create and show enhanced process animation (like regstudent)
                const loader = document.createElement('div');
                loader.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                loader.innerHTML = `
                    <div class="loader-container bg-white p-8 rounded-xl shadow-2xl flex flex-col items-center max-w-md mx-4">
                        <!-- MSU Logo Animation -->
                        <div class="loader-logo mb-6">
                            <div class="w-16 h-16 bg-gradient-to-br from-msu-main-color to-msu-maroon rounded-full flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                                </svg>
                            </div>
                        </div>
                        
                        <!-- Status Message -->
                        <p class="text-gray-700 font-medium text-center mb-2 transition-opacity duration-300">Processing your evaluation submission...</p>
                        <p class="text-sm text-gray-500 text-center transition-opacity duration-300">Please wait while we validate and submit your feedback</p>
                        
                        <!-- Spinning Loader -->
                        <div class="mt-4">
                            <div class="loader animate-spin rounded-full h-8 w-8 border-2 border-msu-main-color border-t-transparent"></div>
                        </div>
                    </div>
                `;
                document.body.appendChild(loader);
                
                // Start the progress animation
                startProgressAnimation();
                
                // Disable submit button
                const submitButton = form.querySelector('button[type="submit"]');
                if (submitButton) {
                    submitButton.disabled = true;
                    submitButton.innerHTML = 'Submitting...';
                }
                
                // Check internet connectivity first
                checkInternetConnection().then(async (isOnline) => {
                    if (!isOnline) {
                        // No internet connection
                        stopAnimationAndShowError('No internet connection detected. Please check your network connection and try again.');
                        return;
                    }
                    
                    // Internet is available, proceed with submission
                    
                    // Prepare form data
                    console.log('Preparing form data...');
                    const formData = new FormData(form);
                    
                    // Debug: Log all form data before creating hidden form
                    console.log('=== FORM DATA COLLECTED ===');
                    let dataCount = 0;
                    for (let pair of formData.entries()) {
                        console.log(pair[0] + ': ' + pair[1]);
                        dataCount++;
                    }
                    console.log('Total form fields:', dataCount);
                    console.log('===============================');
                    
                    if (dataCount === 0) {
                        console.log('ERROR: No form data collected!');
                        stopAnimationAndShowError('No form data found. Please try again.');
                        return;
                    }
                    
                    // Use modern fetch approach to avoid CSP and navigation issues
                    console.log('Submitting via fetch API...');
                    
                    try {
                        const response = await fetch('https://docs.google.com/forms/u/0/d/e/1FAIpQLSfXYmBoB1ZQ9VLVOWq11YODOTFQQfiZGanv7Fvv2EcpO8qq9g/formResponse', {
                            method: 'POST',
                            mode: 'no-cors', // Important for Google Forms
                            body: formData
                        });
                        
                        console.log('Fetch response received');
                        console.log('Response status:', response.status);
                        console.log('Response type:', response.type);
                        
                        // With no-cors mode, we can't read the response, but if we get here, it likely worked
                        console.log('Form submitted successfully via fetch!');
                        
                    } catch (error) {
                        console.error('Error submitting form via fetch:', error);
                        
                        // Fallback to hidden form submission
                        console.log('Trying fallback form submission...');
                        try {
                            const hiddenForm = document.createElement('form');
                            hiddenForm.style.display = 'none';
                            hiddenForm.method = 'POST';
                            hiddenForm.action = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLSfXYmBoB1ZQ9VLVOWq11YODOTFQQfiZGanv7Fvv2EcpO8qq9g/formResponse';
                            
                            formData.forEach((value, key) => {
                                const input = document.createElement('input');
                                input.type = 'hidden';
                                input.name = key;
                                input.value = value.toString();
                                hiddenForm.appendChild(input);
                            });
                            
                            document.body.appendChild(hiddenForm);
                            hiddenForm.submit();
                            
                            // Clean up
                            setTimeout(() => hiddenForm.remove(), 1000);
                            
                        } catch (fallbackError) {
                            console.error('Fallback submission also failed:', fallbackError);
                            stopAnimationAndShowError('Error submitting form. Please try again.');
                            return;
                        }
                    }
                    
                    // Allow animation to complete before showing success message
                    setTimeout(() => {
                        // Remove loader before showing success message
                        loader.remove();
                        showSuccessModal();
                        
                        // Reset form after successful submission
                        setTimeout(() => {
                            form.reset();
                            isSubmitting = false;
                            if (submitButton) {
                                submitButton.disabled = false;
                                submitButton.innerHTML = `
                                    <span>Submit Evaluation</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 -mr-1" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                    </svg>
                                `;
                            }
                        }, 3000);
                    }, 6000); // Wait for animation to complete
                });
            });
        }

        // Simplified status animation function (from regstudent)
        function startProgressAnimation() {
            const statusMessage = document.querySelector('.loader-container p:first-of-type');
            const statusSubtext = document.querySelector('.loader-container p:last-of-type');
            
            const statusMessages = [
                { main: 'Validating your information...', sub: 'Checking form completeness and office selection' },
                { main: 'Processing evaluation responses...', sub: 'Analyzing your ratings and feedback' },
                { main: 'Submitting to server...', sub: 'Sending your evaluation securely' },
                { main: 'Finalizing submission...', sub: 'Preparing confirmation' }
            ];
            
            let currentStep = 0;
            
            function updateStatus() {
                currentStep++;
                
                // Update status messages
                if (statusMessages[currentStep - 1] && statusMessage && statusSubtext) {
                    statusMessage.style.transition = 'opacity 0.4s ease';
                    statusSubtext.style.transition = 'opacity 0.4s ease';
                    statusMessage.style.opacity = '0';
                    statusSubtext.style.opacity = '0';
                    
                    setTimeout(() => {
                        if (statusMessage && statusSubtext) {
                            statusMessage.textContent = statusMessages[currentStep - 1].main;
                            statusSubtext.textContent = statusMessages[currentStep - 1].sub;
                            statusMessage.style.opacity = '1';
                            statusSubtext.style.opacity = '1';
                        }
                    }, 300);
                }
            }
            
            // Start status updates
            setTimeout(() => updateStatus(), 500);
            setTimeout(() => updateStatus(), 1000);
            setTimeout(() => updateStatus(), 1500);
            setTimeout(() => updateStatus(), 2000);
        }
        
        // Function to stop animation and show error
        function stopAnimationAndShowError(message) {
            const loader = document.querySelector('.fixed.inset-0');
            if (loader) {
                loader.remove();
            }
            
            const submitButton = document.querySelector('#evaluationForm button[type="submit"]');
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.innerHTML = `
                    <span>Submit Evaluation</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 -mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                `;
            }
            
            // Reset isSubmitting flag
            isSubmitting = false;
            
            showErrorModal(message);
        }

        // Online/Offline status monitoring
        function showConnectionStatus(isOnline) {
            // Remove any existing connection status
            const existingStatus = document.querySelector('.connection-status');
            if (existingStatus) {
                existingStatus.remove();
            }
            
            if (!isOnline) {
                // Show offline indicator
                const offlineIndicator = document.createElement('div');
                offlineIndicator.className = 'connection-status fixed top-0 left-0 right-0 bg-red-600 text-white text-center py-2 z-50';
                offlineIndicator.innerHTML = `
                    <div class="flex items-center justify-center">
                        <svg class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-2.829 2.829L7 14.5m2.828-5.657a9 9 0 00-2.829 2.829m-2.828 2.828a9 9 0 002.829 2.829M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <span>No Internet Connection - You're currently offline</span>
                    </div>
                `;
                document.body.insertBefore(offlineIndicator, document.body.firstChild);
            }
        }
        
        // Listen for online/offline events
        window.addEventListener('online', () => {
            showConnectionStatus(true);
            // Show a brief success message that connection is restored
            setTimeout(() => {
                const connectionRestored = document.createElement('div');
                connectionRestored.className = 'fixed top-0 left-0 right-0 bg-green-600 text-white text-center py-2 z-50';
                connectionRestored.innerHTML = `
                    <div class="flex items-center justify-center">
                        <svg class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>Connection Restored</span>
                    </div>
                `;
                document.body.insertBefore(connectionRestored, document.body.firstChild);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    if (connectionRestored.parentNode) {
                        connectionRestored.remove();
                    }
                }, 3000);
            }, 500);
        });
        
        window.addEventListener('offline', () => {
            showConnectionStatus(false);
        });
        
        // Check initial connection status
        if (!navigator.onLine) {
            showConnectionStatus(false);
        }

        // Global error handler
        window.addEventListener('error', function(e) {
            console.log('Error caught:', e.error);
            
            // Ignore hiddenForm reference errors since we're using fetch now
            if (e.error && e.error.message && e.error.message.includes('hiddenForm is not defined')) {
                console.log('Ignoring hiddenForm reference error (using fetch instead)');
                return;
            }
            
            if (isSubmitting) {
                showErrorModal('An unexpected error occurred. Please try again.');
                isSubmitting = false;
            }
        });
    });
  </script>








</Layout>