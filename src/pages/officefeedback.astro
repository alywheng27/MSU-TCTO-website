---
// src/pages/feedback.astro
import Layout from '../layouts/Layout.astro';
import Navbar from "../components/Navbar";
import FooterNav from "../components/FooterNav.astro";
import Footer from "../components/Footer.astro";
import Studentsurvey from "../pages/studentsurvey.astro";
import Regstudentsurvey from "../pages/regstudent.astro";
import '../styles/css/global.css';

const currentPath = Astro.url.pathname;
---

<Layout title="MSUTCTO - Office Evaluation and Students Survey">
  <main>
    <Navbar path={currentPath} client:visible />

    <!-- Main Content Container -->
    <div class="min-h-screen bg-gray-50">
      <!-- Tab Navigation -->
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl mb-8 mt-8 sticky top-0 bg-gray-50 z-10 pt-4">
        <div class="flex overflow-x-auto pb-2">
          <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg mr-2 font-medium" data-tab="office-evaluation">
            Office Evaluation
          </button>
          <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg font-medium" data-tab="student-survey">
            New Student Survey
          </button>
            <button class="tab-btn flex-shrink-0 px-6 py-2 rounded-t-lg font-medium" data-tab="studentreg-survey">
            Regular Student Survey
          </button>
        </div>
      </div>

      <!-- Office Evaluation Tab Content -->
      <div id="office-evaluation" class="tab-content">
        <section id="service" class="bg-gradient-to-b from-gray-50 to-white py-16 md:py-24">
          <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl">
            <div class="text-center mb-16">
              <span class="inline-block px-4 py-2 bg-msu-main-color/10 text-msu-main-color text-sm font-semibold rounded-full mb-4">
                Service Feedback
              </span>
              <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
                Office Service <span class="text-msu-main-color">Evaluation</span>
              </h2>
              <div class="w-24 h-1.5 bg-gradient-to-r from-msu-gold to-msu-maroon mx-auto rounded-full"></div>
              <p class="text-lg text-gray-600 mt-6 max-w-2xl mx-auto">
                Your feedback helps us maintain excellence in university services
              </p>
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">
              <div class="bg-gradient-to-r from-msu-main-color to-msu-maroon px-8 py-6">
                <div class="flex items-center">
                  <div class="bg-white/20 p-2 rounded-lg mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-xl font-semibold text-white">Service Quality Assessment</h3>
                    <p class="text-white">Please complete all required fields</p>
                  </div>
                </div>
              </div>

              <div class="p-6 sm:p-8 md:p-10">
                <form 
                  action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfXYmBoB1ZQ9VLVOWq11YODOTFQQfiZGanv7Fvv2EcpO8qq9g/formResponse" 
                  method="POST" 
                  target="hiddenFrame"
                  id="evaluationForm" 
                  class="space-y-10"
                  novalidate
                >
                  <iframe name="hiddenFrame" class="hidden"></iframe>
                  
                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 text-msu-main-color mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 mb-6 border-b pb-2">Office Information</h4>
                        
                        <div class="mb-8">
                          <label for="globalSearch" class="block text-sm font-medium text-gray-700 mb-2">
                            Find Office or Service
                          </label>
                          <div class="relative rounded-lg shadow-sm">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                              <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                              </svg>
                            </div>
                            <input
                              type="text"
                              id="globalSearch"
                              class="block w-full pl-10 pr-12 py-3 border text-gray-700 border-gray-300 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 focus:border-msu-main-color transition-all"
                              placeholder="Search all offices and services..."
                              autocomplete="off"
                            />
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                              <span class="text-gray-500 text-sm hidden sm:inline">Press âŒ˜K</span>
                            </div>
                          </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                          <div class="form-group">
                            <label for="office" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                              Office to Evaluate
                              <span class="text-msu-maroon ml-1">*</span>
                            </label>
                            <div class="mt-1 relative">
                              <select 
                                id="office" 
                                name="entry.1924231474" 
                                required
                                class="office-select block w-full pl-4 pr-10 py-3 text-gray-700 border border-gray-300 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 focus:border-msu-main-color transition-all hover:border-gray-400"
                              >
                                <option value="" disabled selected>Select an office</option>
                                <optgroup label="Administrative Offices" class="text-gray-900">
                                  <option value="BUDGET OFFICE">Budget Office</option>
                                  <option value="INTERNAL CONTROL AND AUDIT UNIT">Internal Control and Audit Unit</option>
                                  <option value="ACCOUNTING OFFICE">Accounting Office</option>
                                  <option value="CASHIERING OFFICE">Cashiering Office</option>
                                  <option value="OFFICE OF THE CHANCELLOR">Office of the Chancellor</option>
                                  <option value="EXTENSION SERVICES">Extension Services</option>
                                  <option value="GENERAL SERVICES OFFICE">General Services Office</option>
                                  <option value="OFFICE OF MEDICAL AND WELLNESS SERVICES">Office of Medical and Wellness Services</option>
                                  <option value="MANILA INFORMATION AND LIAISON OFFICE">Manila Information and Liaison Office</option>
                                  <option value="OFFICE OF THE FINANCE DIR">Office of the Finance Director</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR ADMINISTRATION AND FINANCE">Vice Chancellor for Administration and Finance</option>
                                  <option value="HUMAN RESOURCE DEVELOPMENT OFFICE">Human Resource Development Office</option>
                                  <option value="PHYSICAL PLANT OFFICE">Physical Plant Office</option>
                                  <option value="PROCUREMENT OFFICE">Procurement Office</option>
                                  <option value="RESEARCH SERVICES">Research Services</option>
                                  <option value="SECURITY FORCE">Security Force</option>
                                  <option value="SUPPLY AND PROPERTY OFFICE">Supply and Property Office</option>
                                  <option value="ADMISSION OFFICE">Admission Office</option>
                                  <option value="ALUMNI AND CAREER CENTER OFFICE">Alumni and Career Center Office</option>
                                  <option value="CAGAYAN DE TAWI-TAWI COLLEGE OF ARTS AND SCIENCES EXTENSION">Cagayan de Tawi-Tawi College of Arts and Sciences Extension</option>
                                  <option value="CENTER FOR OCEAN STUDIES">Center for Ocean Studies</option>
                                  <option value="CHILD DEVELOPMENT CENTER">Child Development Center</option>
                                  <option value="COLLEGE LIBRARY">College Library</option>
                                  <option value="COLLEGE OF EDUCATION">College of Education</option>
                                  <option value="INSTITUTE OF INFORMATION AND COMMUNICATIONS TECHNOLOGY">Institute of Information and Communications Technology</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - LANGUAGE DEPARTMENT">College of Arts and Sciences - Language Department</option>
                                  <option value="GRADUATE SCHOOL">Graduate School</option>
                                  <option value="COLLEGE OF FISHERIES">College of Fisheries</option>
                                  <option value="COLLEGE OF ISLAMIC AND ARABIC STUDIES">College of Islamic and Arabic Studies</option>
                                  <option value="COLLEGE OF FISHERIES - MARINE FISHERIES DEPARTMENT">College of Fisheries - Marine Fisheries Department</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - MATHEMATICS AND SCIENCES DEPARTMENT">College of Arts and Sciences - Mathematics and Sciences Department</option>
                                  <option value="OCEANOGRAPHY AND FISH TECHNOLOGY CENTER">Oceanography and Fish Technology Center</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR ACADEMIC SUPPORT SERVICES">Office of the Director for Academic Support Services</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR ACADEMIC AFFAIRS">Office of the Vice Chancellor for Academic Affairs</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - SPEAR DEPARTMENT">College of Arts and Sciences - SPEAR Department</option>
                                  <option value="OFFICE OF THE REGISTRAR">Office of the Registrar</option>
                                  <option value="SCIENCE HIGH SCHOOL">Science High School</option>
                                  <option value="SIBUTU COLLEGE OF ARTS AND SCIENCES EXTENSION">Sibutu College of Arts and Sciences Extension</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES - SOCIAL SCIENCES DEPARTMENT">College of Arts and Sciences - Social Sciences Department</option>
                                  <option value="UNGUS MATATA COLLEGE OF ARTS AND SCIENCES EXTENSION">Ungus Matata College of Arts and Sciences Extension</option>
                                  <option value="BAKONG COMMUNITY HIGH SCHOOL">Bakong Community High School</option>
                                  <option value="BANARAN COMMUNITY HIGH SCHOOL">Banaran Community High School</option>
                                  <option value="BUAN COMMUNITY HIGH SCHOOL">Buan Community High School</option>
                                  <option value="MAPUN COMMUNITY HIGH SCHOOL">Mapun Community High School</option>
                                  <option value="EASTERN TAWI-TAWI SECONDARY SCHOOLS">Eastern Tawi-Tawi Secondary Schools</option>
                                  <option value="LANGUYAN COMMUNITY HIGH SCHOOL">Languyan Community High School</option>
                                  <option value="LARAP COMMUNITY HIGH SCHOOL">Larap Community High School</option>
                                  <option value="MANTABUAN COMMUNITY HIGH SCHOOL">Mantabuan Community High School</option>
                                  <option value="MANUK-MANGKAW COMMUNITY HIGH SCHOOL">Manuk-Mangkaw Community High School</option>
                                  <option value="SAPA-SAPA COMMUNITY HIGH SCHOOL">Sapa-Sapa Community High School</option>
                                  <option value="SIBUTU COMMUNITY HIGH SCHOOL">Sibutu Community High School</option>
                                  <option value="SITANGKAI SITANGKAI HIGH SCHOOL">Sitangkai Sitangkai High School</option>
                                  <option value="SOUTH UBIAN COMMUNITY HIGH SCHOOL">South Ubian Community High School</option>
                                  <option value="TABAWAN COMMUNITY HIGH SCHOOL">Tabawan Community High School</option>
                                  <option value="TAMPAKAN COMMUNITY HIGH SCHOOL">Tampakan Community High School</option>
                                  <option value="TANDUBANAK COMMUNITY HIGH SCHOOL">Tandubanak Community High School</option>
                                  <option value="TUBIG INDANGAN COMMUNITY HIGH SCHOOL">Tubig Indangan Community High School</option>
                                  <option value="UNGUS MATATA COMMUNITY HIGH SCHOOL">Ungus Matata Community High School</option>
                                  <option value="WESTERN TAWI-TAWI COMMUNITY SCHOOL">Western Tawi-Tawi Community School</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL">Integrated Laboratory School</option>
                                  <option value="INFORMATION AND COMMUNICATIONS TECHNOLOGY OFFICE">Information and Communications Technology Office</option>
                                  <option value="REMITTING OFFICE">Remitting Office</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - JUNIOR HIGH SCHOOL DEPARTMENT">Integrated Laboratory School - Junior High School Department</option>
                                  <option value="GRADUATE SCHOOL_SCHOLAR">Graduate School Scholar</option>
                                  <option value="COLLEGE OF EDUCATION_SCHOLAR">College of Education Scholar</option>
                                  <option value="UNGUS MATATA EXTENSION_SCHOLAR">Ungus Matata Extension Scholar</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - STANDARD BASIC EDUCATION CURRICULUM">Integrated Laboratory School - Standard Basic Education Curriculum</option>
                                  <option value="MSU-TCTO LANGUYAN SECONDARY">MSU-TCTO Languyan Secondary</option>
                                  <option value="COLLEGE OF FISHERIES - INLAND FISHERIES DEPARTMENT">College of Fisheries - Inland Fisheries Department</option>
                                  <option value="MAPUN CAS EXTENSION">Mapun CAS Extension</option>
                                  <option value="OFFICE OF THE CAMPUS SECRETARY">Office of the Campus Secretary</option>
                                  <option value="CAFETERIA">Cafeteria</option>
                                  <option value="SAPA COMMUNITY HIGH SCHOOL">Sapa Community High School</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR RESEARCH INNOVATION DEVELOPMENT AND EXTENSION">Office of the Vice Chancellor for Research Innovation Development and Extension</option>
                                  <option value="SECONDARY EDUCATION DEPARTMENT">Secondary Education Department</option>
                                  <option value="BAC SECRETARIAT OFFICE">BAC Secretariat Office</option>
                                  <option value="OFFICE OF THE SUPERVISORS FOR SECONDARY SCHOOLS">Office of the Supervisors for Secondary Schools</option>
                                  <option value="SPORT DEVELOPMENT OFFICE">Sport Development Office</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR ADMINISTRATION">Office of the Director for Administration</option>
                                  <option value="OFFICE OF THE INFORMATION AND PRESS PUBLICATIONS">Office of the Information and Press Publications</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR STUDENT AFFAIRS">Office of the Vice Chancellor for Student Affairs</option>
                                  <option value="OFFICE OF CULTURAL AFFAIRS AND DEVELOPMENT">Office of Cultural Affairs and Development</option>
                                  <option value="INTEGRATED FISHERIES RESEARCH AND TRAINING CENTER (IFRTC)">Integrated Fisheries Research and Training Center (IFRTC)</option>
                                  <option value="MSU-TCTO MAPUN SECONDARY">MSU-TCTO Mapun Secondary</option>
                                  <option value="OFFICE OF INTERNATIONAL LINKAGES">Office of International Linkages</option>
                                  <option value="INTEGRATED SCIENCE LABORATORY">Integrated Science Laboratory</option>
                                  <option value="COLLEGE OF FISHERIES - MULTI-SPECIES HATCHERY">College of Fisheries - Multi-Species Hatchery</option>
                                  <option value="INSTITUTE OF ENVIRONMENTAL SCIENCE">Institute of Environmental Science</option>
                                  <option value="OFFICE OF THE DIRECTOR FOR RESEARCH SERVICES">Office of the Director for Research Services</option>
                                  <option value="MARINE SCIENCE MUSEUM">Marine Science Museum</option>
                                  <option value="OCEANES">OCEANES</option>
                                  <option value="ZAMDIQA">ZAMDIQA</option>
                                  <option value="GENDER AND DEVELOPMENT OFFICE">Gender and Development Office</option>
                                  <option value="OFFICE OF THE AUDITOR">Office of the Auditor</option>
                                  <option value="TAWSIH RESIDENCE HALL">Tawsih Residence Hall</option>
                                  <option value="LINGGISAN RESIDENCE HALL">Linggisan Residence Hall</option>
                                  <option value="INSTITUTE FOR PEACE & DEVELOPMENT IN MINDANAO">Institute for Peace & Development in Mindanao</option>
                                  <option value="RADYO KASANNANGAN">Radyo Kasannangan</option>
                                  <option value="FOOD INNOVATION CENTER">Food Innovation Center</option>
                                  <option value="SAMA STUDIES CENTER">Sama Studies Center</option>
                                  <option value="AMERICAN CORNER">American Corner</option>
                                  <option value="QUALITY ASSURANCE & ACCREDITATION OFFICE">Quality Assurance & Accreditation Office</option>
                                  <option value="COLLEGE OF LAW TAWI-TAWI EXTENSION">College of Law Tawi-Tawi Extension</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - STANDARD MADRASAH EDUCATION CURRICULUM">Integrated Laboratory School - Standard Madrasah Education Curriculum</option>
                                  <option value="SECURITY FORCE BONGAO CAMPUS">Security Force Bongao Campus</option>
                                  <option value="SECURITY FORCE SANGA-SANGA CAMPUS">Security Force Sanga-Sanga Campus</option>
                                  <option value="HENRY V. KONG GYM">Henry V. Kong Gym</option>
                                  <option value="INTEGRATED LABORATORY SCHOOL - SENIOR HIGH SCHOOL DEPARTMENT">Integrated Laboratory School - Senior High School Department</option>
                                  <option value="SENTRO NG WIKA AT KULTURA">Sentro ng Wika at Kultura</option>
                                  <option value="BOYS DORMITORY">Boys Dormitory</option>
                                  <option value="GIRLS DORMITORY">Girls Dormitory</option>
                                  <option value="FLOATING CAGE">Floating Cage</option>
                                  <option value="MSU-TCTO FISHPOND">MSU-TCTO Fishpond</option>
                                  <option value="SEARDEC">SEARDEC</option>
                                  <option value="COLLEGE OF ARTS AND SCIENCES">College of Arts and Sciences</option>
                                  <option value="GUIDANCE AND COUNSELING OFFICE">Guidance and Counseling Office</option>
                                  <option value="OFFICE OF THE VICE CHANCELLOR FOR PLANNING & DEVELOPMENT">Office of the Vice Chancellor for Planning & Development</option>
                                </optgroup>
                              </select>
                              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                              </div>
                            </div>
                            <p class="mt-1 text-sm text-red-600 hidden" id="office-error">Please select an office</p>
                          </div>
                          
                          <div class="form-group">
                            <label for="status" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                              Your Status
                              <span class="text-msu-maroon ml-1">*</span>
                            </label>
                            <div class="mt-1 relative">
                              <select 
                                id="status" 
                                name="entry.724584061" 
                                required
                                class="block w-full pl-4 pr-10 py-3 text-gray-700  border border-gray-300 rounded-lg focus:ring-2 focus:ring-msu-main-color/50 focus:border-msu-main-color transition-all hover:border-gray-400"
                              >
                                <option value="" disabled selected>Select your status</option>
                                <option value="Permanent">Permanent</option>
                                <option value="Temporary">Temporary</option>
                                <option value="Contractual">Contractual</option>
                                <option value="Contract of Service">Contract of Service</option>
                                <option value="Casual">Casual</option>
                                <option value="Regular">Regular</option>
                                <option value="Provisional">Provisional</option>
                                <option value="Othes">Other</option>
                              </select>
                              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                              </div>
                            </div>
                            <p class="mt-1 text-sm text-red-600 hidden" id="status-error">Please select your status</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 text-msu-main-color mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 mb-6 border-b pb-2">Service Ratings</h4>
                        
                        <div class="space-y-8">
                          {[
                            {
                              id: 'job_knowledge',
                              title: 'Job Knowledge',
                              description: 'Understanding and application of job requirements',
                              field: 'entry.1195783547'
                            },
                            {
                              id: 'work_quality',
                              title: 'Service Quality',
                              description: 'Accuracy and effectiveness of service provided',
                              field: 'entry.229158245'
                            },
                            {
                              id: 'responsiveness',
                              title: 'Responsiveness',
                              description: 'Timeliness in addressing requests and concerns',
                              field: 'entry.1473816641'
                            },
                            {
                              id: 'courtesy',
                              title: 'Courtesy',
                              description: 'Professionalism and politeness of staff',
                              field: 'entry.2058011824'
                            },
                            {
                              id: 'overall',
                              title: 'Overall Satisfaction',
                              description: 'Your overall experience with this office',
                              field: 'entry.28013097'
                            }
                          ].map((item) => (
                            <div class="form-group">
                              <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-3">
                                <label class="text-sm font-medium text-gray-700 flex items-center">
                                  {item.title}
                                  <span class="text-msu-maroon ml-1">*</span>
                                </label>
                                <span class="text-xs text-gray-500 mt-1 sm:mt-0">
                                  {item.description}
                                </span>
                              </div>
                              
                              <div class="mt-4">
                                <div class="flex items-center justify-between">
                                  {[1, 2, 3, 4, 5].map((rating) => (
                                    <div class="flex flex-col items-center">
                                      <input
                                        type="radio" 
                                        id={`${item.id}${rating}`}
                                        name={item.field}
                                        value={rating}
                                        required
                                        class="h-5 w-5 text-msu-main-color focus:ring-msu-main-color border-gray-300"
                                      />
                                      <label for={`${item.id}${rating}`} class="mt-2 text-xs font-medium text-gray-500">
                                        {
                                        rating === 1 ? 'Very Poor' : 
                                        rating === 2 ? 'Poor' : 
                                        rating === 3 ? 'Neutral' : 
                                        rating === 4 ? 'Good' : 
                                        rating === 5 ? 'Great' : ''}
                                      </label>
                                    </div>
                                  ))}
                                </div>
                                <p class="mt-1 text-sm text-red-600 hidden" id={`${item.id}-error`}>Please select a rating</p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="space-y-8">
                    <div class="flex items-start">
                      <div class="hidden sm:flex flex-shrink-0 items-center justify-center h-12 w-12 rounded-lg bg-msu-main-color/10 text-msu-main-color mr-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                        </svg>
                      </div>
                      <div class="flex-1">
                        <h4 class="text-lg font-semibold text-gray-900 mb-6 border-b pb-2">Additional Feedback</h4>
                        
                        <div class="form-group">
                          <label for="comments" class="block text-sm font-medium text-gray-700 mb-2">
                            Specific feedback or suggestions for improvement
                          </label>
                          <textarea 
                            id="comments" 
                            name="entry.1589457788" 
                            rows="4"
                            placeholder="Please share any specific experiences or suggestions that could help us improve..."
                            class="block w-full px-4 py-3 text-gray-700 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-msu-main-color/50 focus:border-msu-main-color transition-all hover:border-gray-400"
                          ></textarea>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="pt-6">
                    <div class="flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0">
                      <p class="text-sm text-gray-500">
                        All responses are confidential and will be used for service improvement.
                      </p>
                      <button
                        type="submit"
                        id="submitBtn"
                        class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-gradient-to-r from-msu-main-color to-msu-maroon hover:from-msu-main-color-dark hover:to-msu-maroon-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-msu-main-color transition-all transform hover:-translate-y-0.5 hover:shadow-md disabled:opacity-70 disabled:cursor-not-allowed"
                      >
                        <span id="submitText">Submit Evaluation</span>
                        <svg id="submitSpinner" class="hidden h-5 w-5 ml-2 animate-spin text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <svg id="submitArrow" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 -mr-1" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </section>
      </div>


      <Studentsurvey class="relative z-50"/>
      <Regstudentsurvey class="relative z-50"/>
    <!-- FooterNaV -->
    <FooterNav class="relative z-50"/>
    <!-- end FooterNaV -->
    <!-- Footer -->
    <Footer class="relative z-50"/>
    <!-- end Footer -->
  </main>

  <!-- Modal Structure -->
  <div id="feedbackModal" class="feedback-modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <div class="modal-title">Success!</div>
      </div>
      <div class="modal-body">
        <p id="modalMessage">Your feedback has been submitted successfully!</p>
      </div>
      <div class="modal-footer">
        <button id="modalCloseButton" class="modal-button modal-button-primary">OK</button>
      </div>
    </div>
  </div>

  <style is:global>

    /* Tab Navigation Styles */
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }
    .tab-btn {
      transition: all 0.3s ease;
      background-color: #f3f4f6;
      color: #1e3a8a;
      border: 1px solid #d1d5db;
      position: relative;
    }
    .tab-btn.active {
      background-color: #1e3a8a;
      color: white;
      border-color: #1e3a8a;
    }
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 3px;
      background-color: #1e3a8a;
    }
    
    /* Enhanced Service Selection Styles */
    .service-card {
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      transition: all 0.3s ease;
      cursor: pointer;
      margin-bottom: 1.5rem;
      overflow: hidden;
    }
    
    .service-card:hover {
      border-color: #1e3a8a;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }
    
    .service-card.selected {
      border-color: #1e3a8a;
      background-color: #f0f4ff;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .service-card-header {
      display: flex;
      align-items: center;
      padding: 1.25rem;
      position: relative;
      padding-left: 3.5rem !important;
      background-color: white;
    }
    
    .service-card-icon {
      flex-shrink: 0;
      height: 2.5rem;
      width: 2.5rem;
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      background-color: #1e3a8a10;
      color: #1e3a8a;
      transition: all 0.3s ease;
    }
    
    .service-card.selected .service-card-icon {
      background-color: #1e3a8a;
      color: white;
    }
    
    .service-card-title {
      font-weight: 600;
      color: #111827;
      font-size: 1.1rem;
    }
    
    .service-card-checkbox {
      position: absolute;
      opacity: 0;
    }
    
    .service-questions {
      display: none;
      padding: 1.5rem;
      border-top: 1px solid #e5e7eb;
      background-color: #f9fafb;
    }
    
    .service-card.selected .service-questions {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    /* Verification Status Styles */
    .verification-status {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      z-index: 2;
    }
    
    .verification-status.verified {
      background-color: #10B981;
      color: white;
    }
    
    .verification-status.completed {
      background-color: #F59E0B;
      color: white;
    }
    
    .verification-status.not-completed {
      background-color: #EF4444;
      color: white;
    }
    
    .verification-legend {
      background-color: #F9FAFB;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
      border: 1px solid #E5E7EB;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .verification-legend-item {
      display: flex;
      align-items: center;
      font-size: 0.875rem;
      color: #4B5563;
    }
    
    .verification-legend-badge {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      margin-right: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }
    
    .verification-legend-badge.verified {
      background-color: #10B981;
      color: white;
    }
    
    .verification-legend-badge.completed {
      background-color: #F59E0B;
      color: white;
    }
    
    .verification-legend-badge.not-completed {
      background-color: #EF4444;
      color: white;
    }

    /* Modal Styles */
    .feedback-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    
    .feedback-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-content {
      background-color: white;
      border-radius: 12px;
      width: 90%;
      max-width: 450px;
      transform: translateY(20px);
      transition: all 0.3s ease;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    .feedback-modal.active .modal-content {
      transform: translateY(0);
    }
    
    .modal-header {
      padding: 1.5rem;
      display: flex;
      align-items: center;
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
      color: white;
    }
    
    .modal-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
    }
    
    .modal-body {
      padding: 1.5rem;
      color: #4b5563;
      line-height: 1.6;
    }
    
    .modal-footer {
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: flex-end;
      border-top: 1px solid #e5e7eb;
    }
    
    .modal-button {
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .modal-button-primary {
      background-color: #1e3a8a;
      color: white;
      border: none;
    }
    
    .modal-button-primary:hover {
      background-color: #1e40af;
    }
    
    /* Success/Error Specific Styles */
    .modal-success .modal-icon {
      background-color: rgba(16, 185, 129, 0.2);
    }
    
    .modal-error .modal-icon {
      background-color: rgba(239, 68, 68, 0.2);
    }
    
    /* Loading Spinner */
    .submit-loading {
      display: inline-flex;
      align-items: center;
    }
    
    .spinner {
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
    }

    /* Progress tracker */
    .studentprogress-tracker {
      position: fixed;
      bottom: 2rem;
      left: 2rem;
      background: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      z-index: 20;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .studentprogress-tracker:hover {
      transform: scale(1.1);
    }
    
    .progress-circle {
      position: relative;
      width: 50px;
      height: 50px;
    }
    
    .progress-bg {
      fill: none;
      stroke: #e5e7eb;
      stroke-width: 4;
    }
    
    .progress-fill {
      fill: none;
      stroke: #1e3a8a;
      stroke-width: 4;
      stroke-linecap: round;
      transform-origin: center;
      transform: rotate(-90deg);
      transition: stroke-dashoffset 0.5s ease;
    }
    
    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.75rem;
      font-weight: bold;
      color: #1e3a8a;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideDown {
      from { 
        opacity: 0;
        transform: translateY(-10px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive adjustments */
    @media (max-width: 640px) {
      .service-card-header {
        padding-left: 2.5rem !important;
      }
      
      .verification-status {
        left: 0.75rem;
        width: 20px;
        height: 20px;
        font-size: 10px;
      }
      
      .progress-tracker {
        bottom: 1rem;
        right: 1rem;
        width: 50px;
        height: 50px;
      }
    }
  </style>

  <script is:inline>
    // Enhanced Global Search Functionality and Form Submission
    document.addEventListener('DOMContentLoaded', function() {
        // Global Search Functionality
        const globalSearch = document.getElementById('globalSearch');
        const officeSelect = document.getElementById('office');
        const originalOptions = Array.from(officeSelect.options);
        
        // Create search results dropdown
        const searchResults = document.createElement('div');
        searchResults.className = 'absolute z-10 mt-1 w-full bg-white text-black shadow-lg rounded-lg border border-gray-300 hidden';
        searchResults.id = 'searchResults';
        globalSearch.parentNode.appendChild(searchResults);
        
        // Keyboard shortcut hint
        globalSearch.addEventListener('keydown', function(e) {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                this.focus();
            }
        });
        
        globalSearch.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            searchResults.innerHTML = '';
            
            if (searchTerm.length < 2) {
                searchResults.classList.add('hidden');
                return;
            }
            
            // Filter options
            const matches = originalOptions.filter(option => 
                option.value && option.text.toLowerCase().includes(searchTerm)
            );
            
            // Group by optgroup
            const grouped = {};
            matches.forEach(option => {
                const group = option.parentNode.label || 'Other Offices';
                if (!grouped[group]) grouped[group] = [];
                grouped[group].push(option);
            });
            
            // Display results
            if (Object.keys(grouped).length > 0) {
                for (const [groupName, options] of Object.entries(grouped)) {
                    const groupHeader = document.createElement('div');
                    groupHeader.className = 'px-4 py-2 bg-gray-50 text-sm font-medium text-gray-700 border-b';
                    groupHeader.textContent = groupName;
                    searchResults.appendChild(groupHeader);
                    
                    options.forEach(option => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center';
                        resultItem.innerHTML = `
                            <svg class="h-5 w-5 text-gray-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            ${option.text}
                        `;
                        
                        resultItem.addEventListener('click', () => {
                            officeSelect.value = option.value;
                            globalSearch.value = '';
                            searchResults.classList.add('hidden');
                        });
                        
                        searchResults.appendChild(resultItem);
                    });
                }
                
                searchResults.classList.remove('hidden');
            } else {
                const noResults = document.createElement('div');
                noResults.className = 'px-4 py-2 text-gray-500';
                noResults.textContent = 'No offices found matching your search';
                searchResults.appendChild(noResults);
                searchResults.classList.remove('hidden');
            }
        });
        
        // Hide results when clicking outside
        document.addEventListener('click', function(e) {
            if (!globalSearch.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.classList.add('hidden');
            }
        });
        
        // Form Validation and Submission
        const form = document.getElementById('evaluationForm');
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const submitSpinner = document.getElementById('submitSpinner');
        const submitArrow = document.getElementById('submitArrow');
        
        // Validate form on submit
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Reset error states
            document.querySelectorAll('.text-red-600').forEach(el => el.classList.add('hidden'));
            let isValid = true;
            
            // Validate required fields
            const office = document.getElementById('office');
            if (!office.value) {
                document.getElementById('office-error').classList.remove('hidden');
                isValid = false;
            }
            
            const status = document.getElementById('status');
            if (!status.value) {
                document.getElementById('status-error').classList.remove('hidden');
                isValid = false;
            }
            
            // Validate rating fields
            const ratingFields = [
                'job_knowledge',
                'work_quality',
                'responsiveness',
                'courtesy',
                'overall'
            ];
            
            ratingFields.forEach(field => {
                const selected = document.querySelector(`input[name="entry.${field === 'job_knowledge' ? '1195783547' : 
                    field === 'work_quality' ? '229158245' : 
                    field === 'responsiveness' ? '1473816641' : 
                    field === 'courtesy' ? '2058011824' : '28013097'}"]:checked`);
                if (!selected) {
                    document.getElementById(`${field}-error`).classList.remove('hidden');
                    isValid = false;
                }
            });
            
            if (!isValid) {
                // Scroll to first error
                const firstError = document.querySelector('.text-red-600:not(.hidden)');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }
            
            // Show loading state
            submitBtn.disabled = true;
            submitText.textContent = 'Submitting...';
            submitArrow.classList.add('hidden');
            submitSpinner.classList.remove('hidden');
            
            try {
                // Submit to Google Forms
                const formData = new FormData(form);
                
                // Create a fallback timeout in case the iframe doesn't load
                const submissionTimeout = setTimeout(() => {
                    showResultModal('success', 'Evaluation submitted successfully!');
                    form.reset();
                    resetSubmitButton();
                }, 5000);
                
                // Listen for iframe load (though Google Forms doesn't provide a proper response)
                const iframe = document.querySelector('iframe[name="hiddenFrame"]');
                iframe.onload = function() {
                    clearTimeout(submissionTimeout);
                    showResultModal('success', 'Evaluation submitted successfully!');
                    form.reset();
                    resetSubmitButton();
                };
                
                // Submit the form
                form.submit();
                
            } catch (error) {
                showResultModal('error', 'There was an error submitting your evaluation. Please try again.');
                resetSubmitButton();
            }
        });
        
        function resetSubmitButton() {
            submitBtn.disabled = false;
            submitText.textContent = 'Submit Evaluation';
            submitSpinner.classList.add('hidden');
            submitArrow.classList.remove('hidden');
        }
        
        function showResultModal(type, message) {
            // Remove any existing modals
            const existingModal = document.querySelector('.form-result-modal');
            if (existingModal) existingModal.remove();
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/50 form-result-modal';
            
            const iconColor = type === 'success' ? 'text-green-600' : 'text-red-600';
            const iconBg = type === 'success' ? 'bg-green-100' : 'bg-red-100';
            const iconPath = type === 'success' ? 
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />' :
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
            
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl">
                    <div class="flex items-center justify-center h-16 w-16 ${iconBg} rounded-full mx-auto mb-4">
                        <svg class="h-8 w-8 ${iconColor}" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            ${iconPath}
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 text-center mb-2">${type === 'success' ? 'Success!' : 'Error!'}</h3>
                    <p class="text-gray-600 text-center mb-6">${message}</p>
                    <button onclick="this.closest('.form-result-modal').remove()" class="w-full px-4 py-2 bg-msu-main-color text-white rounded-lg hover:bg-msu-maroon transition-colors">
                        Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Auto-close after 5 seconds
            setTimeout(() => {
                modal.remove();
            }, 5000);
        }

        // Close pop-out advertisement
        const popoutAd = document.querySelector('.fixed.bottom-4.right-4');
        if (popoutAd) {
            const closeBtn = popoutAd.querySelector('button');
            closeBtn.addEventListener('click', () => {
                popoutAd.style.display = 'none';
            });
        }
    });
  </script>








</Layout>